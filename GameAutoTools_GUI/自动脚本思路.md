# 自动脚本思路

## 1. 基础信息

1. 通行证总等级共115级，每升一级需要1000经验值，从0级升级115级所需**总经验值为115000**

2. 脚本自动打一局经验获得经验值35，每局需要花费14分钟，一小时能打4把，也就是**每小时获得经验值140**

3. 不间断的使用脚本打游戏，**从0级升115级需要的时间**：115000/140≈821.4小时≈34天+6小时≈**35天**

##  2.脚本思路

### 2.1 代码流程

1. initSelf函数：

   1. \__init__函数：初始化类的属性
   2. 解绑OP绑定过的窗口
   3. BaseSet.initOP()：OPFuncs文件的类方法，进行OP对象的初始化
   4. WindowOP.get_window_by_name()：OPFuncs文件的类方法，获取窗口句柄hwnd
   5. WindowOP.bind_window()：OPFuncs文件的类方法，将窗口句柄hwnd绑定到OP对象
   6. WindowOP.getRatio()：OPFuncs文件的类方法，获取坐标系的倍数关系（如果系统的显示缩放不为0，那么一定存在倍数关系ratioX，ratioY。比如移动鼠标到坐标[20, 50]，那么OP插件的MoveTo函数的传入参数就应该是20/ratioX, 50/ratioY。）
   7. WindowOP.update_window()：OPFuncs文件的类方法，更新窗口的信息
   8. updateWindowState函数：更新窗口状态
   9. recoverWindowState函数：重置窗口状态

2. auto_play函数：While死循环

   1. UserPause()函数：监测用户是否进行主动暂停
   2. getCurUI()函数：获取当前界面类型
   3. if匹配

   

### 2.2 getCurUI函数思路：

***

**正常界面**

1. 登录界面1-公告

2. 登录界面2-适龄提示

3. 游戏内界面识别：preUI为

4. 结算界面识别

5. 主界面识别

6. 英雄选择界面识别

7. 跳点选择界面识别（未实现）

8. 游戏内ESC选择界面

9. 主界面ESC选择界面

10. 可以跳过的意外界面识别

***
**异常界面** 


9. 错误界面

   1. 主界面错误：提示，失去服务器连接
   1. 登录界面2错误：提示，账号异常

10. 过渡界面UITransition：不满足以上情况（没有特征区域+特征字符串，没有特征图片的界面）

    1. preUI为正常界面即可。
    2. 持续时间不超过指定时间：10秒
    3. 处于该界面时，什么都不做，等待自动跳过即可。






- 进入主循环（循环次数：count）
  - 判断当前界面【get_cur_UI】：
    - 主界面：【UI_main_fun：Human_machine_mode/Conquest_mode】选择模式：人机/征神，进入游戏
    - 选择界面【UI_select_fun：Hero，landing_site】：选择英雄、选择跳点，等待游戏开始
    - 游戏内界面【UI_game_fun】：重复进行：随机移动，右键蓄力后释放、左键蓄力蓄力后释放
      - 没有武器，且血条健康：重复进行：移动+跳跃+拾取
      - 没有武器，血条不健康：重复进行：右键蓄力后释放、左键蓄力蓄力后释放
      - 有武器：重复进行：右键蓄力后释放、左键蓄力蓄力后释放
    - 结算界面1-击败信息【UI_settlement_fun1】：按下空格
    - 结算界面2-经验信息【UI_settlement_fun2】：按下空格

### 2.2 关键函数getCurUI：实现思路





# 还需要实现的功能

1. 人机交互界面
2. 在界面中可以选择“机型”（服务器/Thinkbook）、游戏模式（无尽试炼/征神雪满弓刀）
3. 在界面可以有两种方式的停止游戏
   1. 暂停30秒
   2. 打完本局结束脚本
4. 界面显示：已经打了多少把游戏、每把游戏消耗的时间、每把游戏获得的经验、总经验……
5. 记录日志
